= Page Title Link =

Page Title Link example demonstrates how to create tree like navigation dynamically with !JavaScript.

== Design ==

The Page Title Link example is much like the [wiki:Tree Tree Structure] example, with an added item for navigating back to the main level.

For more information on Page Title Link flow model, please see the 
[http://www.developer.nokia.com/Resources/Library/Series_40_web_apps_library/#!design-library-intoduction/application-flow-models.html Series 40 web apps design library].

==== Page Title Link help text: ====
Page title link demonstrates how tapping the page title brings people back to the start view of this mini app. This pattern should be used in case the primary function is reserved for something else than “back” or “home” navigation.

[[Image(page_title_link.png)]]

== Implementation ==

=== Structure ===
The Page Title Link mini app's HTML structure is really simple; it's just a top level container that get's most of its contents dynamically from the intermediate proxy server. The real structure is defined from within the logic written in !JavaScript. Only the header link returning the user back to the main level is defined statically.

{{{
<!--PageTitleLink mini app-->
<div id="pageTitleLink" class="slider_section hide">
  <div class="title_link_header" 
     onclick="
       generateTreeView('pageTitleLink_content',0,0,0);
     ">Press title link to main page</div>
  <div id="pageTitleLink_content"></div>
</div>
<!--End PageTitleLink mini app-->
}}}

=== Logic ===
The !JavaScript function generateTreeView() handles generating the tree view HTML structure to the given elementId. It generates function calls to itself to tree's list element onclick handlers, so in a way the function is used recursively.

NOTE: If this example would have to be implemented without creating the content dynamically, the whole tree structure should be defined in the HTML. If each of the lists have 4 items, this would mean 4 * 4 = 16 different views with 2 levels deep tree structure. Also, the transitions between the different pages would have to be done purely with MWL functions.

{{{
#!js
/**
 * Function for generating HTML structure for the tree view mini app.
 * 
 *   elementId - HTML element id to which the output is appended.
 *   pageLevel - The current depth of the tree
 *   index1 - The item index selected from the tree's first level.
 *   index2 - The item index selected from the tree's second level.
 */
function generateTreeView(elementId, pagelevel, index1, index2) {
	var pageNames = ["A", "B", "C", "D"];
	var pageCount = pageNames.length;
	
	var treeStructureContainer = document.getElementById(elementId);
	treeStructureContainer.innerHTML = "";
	
	var headerstr = '<div class="list_section_header">Tree ';
	var outputstr = '<div id="tree_page_content" class="show">';
	
	if (pagelevel === 0) {
		for (var i = 0; i < pageCount ; i++) {
			outputstr += '<div class="text_list_item"'
					  + 'onclick="generateTreeView(\'' + elementId + '\',1,' + i + ',' + '0' + ')">'
					  + 'Item ' + (i+1) + '</div>';
		}
		mwl.setGroupTarget('#navigateToggle', '#miniappGoHomeToggle', 'show', 'hide');
	} else if (pagelevel === 1) {
		headerstr += '> Item ' + (index1+1);
		for (var i = 0; i < pageCount ; i++) {
			outputstr += '<div class="text_list_item"'
					  + 'onclick="generateTreeView(\'' + elementId + '\',2,' + index1 + ',' + i + ')">'
					  + 'Item ' + pageNames[i] + '</div>';
		}
		setBackButton(elementId, pagelevel, index1);
	} else if (pagelevel === 2) {
		headerstr += '> Item ' + (index1+1) + ' > ' + pageNames[index2];
		outputstr += '<div class="text_block">'
				  + 'Content item ' + (index1+1)
				  + ' - ' + pageNames[index2] + '</div>';
		setBackButton(elementId, pagelevel, index1);
	} else {
		// Handle error here.
	}
	// Close the header string
	headerstr += '</div>';
	
	treeStructureContainer.innerHTML += headerstr;
	treeStructureContainer.innerHTML += outputstr;
}
}}}

The helper method used in the generateTreeView. Simply sets a correct kind of click handler to the Back button and shows it.
{{{
#!js
/**
 * Helper function for setting back button behaviour.
 */
function setBackButton(elementId, pagelevel, index1) {
	var treeBackButton = document.getElementById("tree_backButton");
	treeBackButton.onclick = function() {
		generateTreeView(elementId, pagelevel - 1, index1, 0); 
	};
	mwl.setGroupTarget('#navigateToggle', '#tree_backButton', 'show', 'hide');
}
}}}

=== Style and transitions ===
The CSS classes used in the Page Title Link mini app are pretty much the same ones as in e.g. the Lists example.

{{{
.list_section_header {
	background-color: #ced3c6;
	color: white;
	height: 20px;
	padding-left: 12px;
	font-size: 14px;
	font-weight: bold;
	line-height: 20px;
}

.text_list_item { 
	background-color: #fff;
	padding: 11px 8px 11px 8px;
	font-weight: bold;
	border-bottom: 1px #e7e7e7 solid;
	font-size: 16px;
}

.text_block {
	padding: 8px;
}
}}}